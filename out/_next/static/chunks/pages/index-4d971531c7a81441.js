(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(2285)}])},2285:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return h}});var r=t(5893),a=t(7294),i=t(3206),s=t(6313),c=t(4567),l=t.n(c),o=t(5733),d=t.n(o),u=t(3162);function h(){var e,n,t;let c=["Cooking.....","Brewing Cofee...","Siam Arif Gay","Auto Chai","WaItin","Sure fail","Get a life, will you?","BUET er porei KUET","CSE Amar passion","KUET iss <3,,, what yikEs"],o=(0,a.useRef)(null),h=(0,a.useRef)(null),f=(0,a.useRef)(null),g=(0,a.useRef)(null),p=(0,a.useRef)(null),w=(0,a.useRef)(null),m=(0,a.useRef)(null),v=(0,a.useRef)(null),x=(0,a.useRef)(null),y=(0,a.useRef)(null),_=(0,a.useRef)(null),C=(0,a.useRef)(null),j=(0,a.useRef)(null),P=(0,a.useRef)(null),k={loaded:!1,currentPage:-1,currentChar:"a",pdf:null},b=new Map,S=[...Array(26)].map((e,n)=>(n+10).toString(36)),N=new Map(S.map(e=>[e,0])),M=new Map(S.map(e=>[e,[]]));async function E(t){H();let r=t.target.files[0],a=new Uint8Array(await r.arrayBuffer());await s.Me(a).promise.then(t=>{k.pdf=t,f.current.innerHTML=t.numPages,console.log(t.numPages),t.getPage(1).then(function(t){k.currentPage=1,y.current.value=1,console.log(k);var r=h.current;r.width=80*(window.innerWidth||document.clientWidth||document.body.clientWidth)/100;var a=t.getViewport({scale:r.width/t.getViewport({scale:1}).width});r.height=a.height,w.current.width=h.current.width,w.current.height=h.current.height,e.setWidth(r.width),e.setHeight(r.height),t.render({canvasContext:n,viewport:a}).promise.then(()=>{g.current.style.display="none",p.current.style.display="block",A()})})})}async function L(){let e=new(d());for(let[n,t]of M.entries()){let r=e.folder(n);t.forEach((e,n)=>{r.file("sample".concat(n+1,".png"),e,{binary:!0})})}return await new Promise(n=>e.generateAsync({type:"blob"}).then(e=>n(e)))}async function R(){H();for(let e=1;e<=k.pdf.numPages;e++)await U(!1,e,!0),await T(),console.log(e);console.log(M),(0,u.saveAs)(await L(),"dataset.zip"),A()}async function T(){for(let n of e.getObjects("rect")){w.current.width=n.width,w.current.height=n.height;let e=n.aCoords.bl.x+n.aCoords.br.x+n.aCoords.tl.x+n.aCoords.tr.x,r=n.aCoords.bl.y+n.aCoords.br.y+n.aCoords.tl.y+n.aCoords.tr.y;e/=4,r/=4,t.save();let a=-n.angle*Math.PI/180;t.translate(e,r),t.rotate(a),t.translate(-e,-r),t.drawImage(h.current,0,0),t.restore(),t.drawImage(h.current,e-n.width/2,r-n.height/2,n.width,n.height,0,0,n.width,n.height),await new Promise(e=>w.current.toBlob(t=>{M.get(n.char).push(t),e(null)}))}}function B(n){if(n.keyCode>=65&&n.keyCode<=90){let e=String.fromCharCode(n.keyCode);k.currentChar=e.toLowerCase(),console.log(k.currentChar),v.current.innerHTML=e.toLowerCase(),console.log(k)}else(8==n.keyCode||46==n.keyCode)&&document.activeElement!=y.current&&(console.log("Delete Selected : DEL/BackSpace pressed"),function(){if(e.getActiveObject()){let n=e.getActiveObject().char;N.set(n,N.get(n)-1),document.querySelector("#state_".concat(n," > span")).innerHTML=N.get(n),e.remove(e.getActiveObject())}C.current.innerHTML="-"}())}function H(){o.current.innerHTML="<span>"+(.9>Math.random()?"Waiting":c[Math.floor(Math.random()*c.length)])+"</span>",o.current.style.display="block"}function A(){o.current.style.display="none"}async function U(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t?(r=k.currentPage+r,y.current.value=r):0==r?r=""==y.current.value?k.currentPage:parseInt(y.current.value):y.current.value=r,console.log(r),a||H(),isNaN(r)||r<1||r>k.pdf.numPages)return console.log("Outside Bound : ",r," Total pages : "+k.pdf.numPages);let i=await new Promise(e=>k.pdf.getPage(r).then(function(n){e(n)}));b.set(k.currentPage,e.toObject(["char"])),e.clear(),k.currentPage=r;var s=h.current;s.width=85*(window.innerWidth||document.clientWidth||document.body.clientWidth)/100;var c=i.getViewport({scale:s.width/i.getViewport({scale:1}).width});w.current.height=h.current.height,void 0===b.get(k.currentPage)?e.setHeight(s.height):await new Promise(n=>e.loadFromJSON(b.get(k.currentPage),()=>{e.requestRenderAll(),n()})),await new Promise(e=>i.render({canvasContext:n,viewport:c}).promise.then(()=>{e()})),a||A()}return(0,a.useEffect)(()=>{if(document.body.addEventListener("keyup",B),m)return e=new i.Xz(m.current,{selection:!1}),n=h.current.getContext("2d"),t=w.current.getContext("2d"),e.on("mouse:down",n=>{if(void 0===n.target){C.current.innerHTML="-";let t=new i.UL({left:n.e.offsetX-15,top:n.e.offsetY-37.5,fill:"#00FF00AA",width:30,height:75,lockScalingFlip:!0,lockSkewingX:!0,lockSkewingY:!0});t.char=k.currentChar,t.on("scaling",function(){let e=1!=this.scaleX?this.scaleX:this.scaleY;console.log(e,this.scaleX,this.scaleY,this),this.set({width:this.width*e,height:this.width*e*2.5,scaleX:1,scaleY:1})}),e.add(t),N.set(k.currentChar,N.get(k.currentChar)+1),document.querySelector("#state_".concat(k.currentChar," > span")).innerHTML=N.get(k.currentChar)}else C.current.innerHTML=n.target.char}),()=>{e.dispose()}}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{ref:o,style:{display:"none"},className:l().wait}),(0,r.jsxs)("div",{ref:P,className:l().layerContainer,children:[(0,r.jsx)("canvas",{ref:h,className:l().pdf}),(0,r.jsx)("canvas",{ref:w,className:l().canvasHidden}),(0,r.jsx)("canvas",{ref:m,className:l().anno})]}),(0,r.jsxs)("div",{className:l().SidePane,children:[(0,r.jsxs)("div",{className:l().charView,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{ref:v,children:"a"}),(0,r.jsx)("p",{children:"new"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{ref:C,children:"-"}),(0,r.jsx)("p",{children:"new"})]})]}),(0,r.jsx)("div",{ref:j,className:l().StatusBar,children:S.map(e=>(0,r.jsxs)("div",{id:"state_"+e,onClick:()=>{k.currentChar=e,v.current.innerHTML=e},children:[(0,r.jsx)("b",{children:e})," ",(0,r.jsxs)("span",{children:[" ",N.get(e)," "]})]},e))}),(0,r.jsxs)("div",{ref:g,className:l().preUP,children:[(0,r.jsx)("label",{for:"fileU",children:"Select"}),(0,r.jsx)("input",{type:"file",id:"fileU",accept:"application/pdf",onChange:E})]}),(0,r.jsxs)("div",{ref:p,style:{display:"none"},children:[(0,r.jsxs)("div",{className:l().navBar,children:[(0,r.jsx)("input",{type:"button",ref:x,onClick:()=>U(!0,-1)}),(0,r.jsx)("input",{type:"number",ref:y,onBlur:()=>U(!1,0)}),(0,r.jsx)("span",{ref:f,children:"\xa0"}),(0,r.jsx)("input",{type:"button",ref:_,onClick:()=>U(!0,1)})]}),(0,r.jsx)("div",{className:l().SideControls,children:(0,r.jsx)("input",{type:"submit",value:"Download",onClick:R})})]})]})]})}},4567:function(e){e.exports={SidePane:"index_SidePane__284M2",wait:"index_wait__6jScL",SideControls:"index_SideControls__ILKgi",StatusBar:"index_StatusBar__EFtZO",layerContainer:"index_layerContainer__Wp8Kg",pdf:"index_pdf__k9kFa",anno:"index_anno__YPur4",canvasHidden:"index_canvasHidden__PXarP",charView:"index_charView__hqBGk",navBar:"index_navBar__SXd_c",preUP:"index_preUP__CUImo"}}},function(e){e.O(0,[928,140,372,888,774,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);